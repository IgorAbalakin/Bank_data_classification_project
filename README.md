# PROJECT-4. Задача классификации

### Оглавление 
[1. Описание проекта](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Описание-проекта) 

[2. Первичная обработка данных](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Первичная-обработка-данных) 

[3. Разведывательный анализ данных](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Разведывательный-анализ-данных) 

[4. Отбор и преобразование признаков](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Отбор-и-преобразование-признаков) 

[5. Логистическая регрессия и решающие деревья](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Логистическая-регрессия-и-решающие-деревья) 

[6. Ансамбли моделей](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Ансамбли-моделей) 
 
____
### Описание проекта 
Банки хранят огромные объёмы информации о своих клиентах. Эти данные можно использовать для того, чтобы оставаться на связи с клиентами и индивидуально ориентировать их на подходящие именно им продукты или банковские предложения.

Обычно с выбранными клиентами связываются напрямую через разные каналы связи: лично (например, при визите в банк), по телефону, по электронной почте, в мессенджерах и так далее. Этот вид маркетинга называется прямым маркетингом. На самом деле, прямой маркетинг используется для взаимодействия с клиентами в большинстве банков и страховых компаний. Но, разумеется, проведение маркетинговых кампаний и взаимодействие с клиентами — это трудозатратно и дорого.

Банкам хотелось бы уметь выбирать среди своих клиентов именно тех, которые с наибольшей вероятностью воспользуются тем или иным предложением, и связываться именно с ними.

Имеются данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Необходимо проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк. 

*Бизнес-задача:* определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.

*Техническая задача*: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.
 
:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Оглавление)

 ____
### Первичная обработка данных

Данные о клиентах банка:

        age (возраст);
        job (сфера занятости);
        marital (семейное положение);
        education (уровень образования);
        default (имеется ли просроченный кредит);
        housing (имеется ли кредит на жильё);
        loan (имеется ли кредит на личные нужды);
        balance (баланс).

Данные, связанные с последним контактом в контексте текущей маркетинговой кампании:

        contact (тип контакта с клиентом);
        month (месяц, в котором был последний контакт);
        day (день, в который был последний контакт);
        duration (продолжительность контакта в секундах).

Прочие признаки:

        campaign (количество контактов с этим клиентом в течение текущей кампании);
        pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
        previous (количество контактов до текущей кампании)
        poutcome (результат прошлой маркетинговой кампании).

Целевая переменная - deposit, которая определяет, согласится ли клиент открыть депозит в банке.


:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Оглавление)

____
### Разведывательный анализ данных

В данной части проекта необходимо выполнить:

        - исследование данные;
        - поиск закономерностей, позволяющих сформулировать предварительные гипотезы относительно того, какие факторы являются решающими для оформления депозита;
        - построение визуализаций, иллюстрирующих исследование.



:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Оглавление)

 ____
### Отбор и преобразование признаков

Перед построением модели необходимо выполнить следующие шаги:

        1. Алгоритмы машинного обучения не могут обрабатывать категориальные признаки в их обычном виде. По ходу работы алгоритм считает показатели (например, средние значения), которые можно вычислить только для количественных признаков. Поэтому нам необходимо преобразовать категориальные признаки в более удобный формат.
        2. Масштабировать и трансформировать некоторые признаки для того, чтобы улучшить качество модели.
        3. Отобрать признаки, которые для использования для обучения модели.


:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Оглавление)
 
____
### Логистическая регрессия и решающие деревья

В данной части проекта необходимо выполнить:

        1. Для начала необходимо самый простой алгоритм — логистическую регрессию. В качестве алгоритма оптимизации использовать 'sag', в качестве значения параметра random_state число 42, выполнить 1000 итераций.
        2. Затем ещё один алгоритм — решающие деревья. В качестве параметров для начала следующие:
        criterion = 'entropy';
        random_state = 42.
        Остальные параметры оставьте по умолчанию.
        - построение визуализаций, иллюстрирующих исследование.
        3. Использовать оптимизацию и подобрать оптимальные гиперпараметры, при которых дерево решений будет давать наиболее точный прогноз


:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Оглавление)
 
____
### Ансамбли моделей

1. Обучить случайный лес со следующими параметрами:

        n_estimators = 100;
        criterion = 'gini';
        min_samples_leaf = 5;
        max_depth = 10;
        random_state = 42.

2. Сравнить полученные результаты с моделью градиентного бустинга. Использовать градиентный бустинг для решения задачи классификации, задав для него следующие параметры:

        learning_rate = 0.05;
        n_estimators = 300;
        min_samples_leaf = 5;
        max_depth = 5;
        random_state = 42.


3. Использовать стекинг, объединив те алгоритмы, которые уже использовались ранее: решающие деревья, логистическую регрессию и градиентный бустинг.

4. Ранее рассматривалась оптимизация гиперпараметров при помощи GridSearch. Однако, это не единственный способ. Один из более продвинутых вариантов оптимизации гиперпараметров — фреймворк Optuna. Для перебора необходимо использовать случайный лес и следующие параметры:

        n_estimators = trial.suggest_int('n_estimators', 100, 200, 1);
        max_depth = trial.suggest_int('max_depth', 10, 30, 1);
        min_samples_leaf = trial.suggest_int('min_samples_leaf', 2, 10, 1).


:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Bank_data_classification_project/blob/main/README.md#Оглавление)
 
 ____
